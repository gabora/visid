%% Input file for parameter estimation using AMIGO2.


%%
% inputs
%

%%
% inputs.PEsol
%

inputs.PEsol.PEcostJac_type=	'llk';
inputs.PEsol.PEcost_type=	'llk';
inputs.PEsol.global_theta_max=	[	         0.1            1            1            1            1            1            1            1            1            1          100            1            1          100          0.1          0.1          0.1          0.1 ];
inputs.PEsol.global_theta_min=	[	      1e-006       0.0001       1e-006       0.0001       1e-006       1e-006       1e-005       1e-005       1e-006       1e-005          0.1       1e-005       1e-005        0.001       1e-005       1e-005       1e-005       1e-005 ];
inputs.PEsol.global_theta_guess=	exp(log(inputs.PEsol.global_theta_min) + rand(1,18).*(log(inputs.PEsol.global_theta_max) - log(inputs.PEsol.global_theta_min)));
inputs.PEsol.id_global_theta=	char(	'k1 ',...
	'k2 ',...
	'k4 ',...
	'k5 ',...
	'k6 ',...
	'k7 ',...
	'k8 ',...
	'k9 ',...
	'k10',...
	'k11',...
	'k12',...
	'k13',...
	'k14',...
	'k15',...
	'k16',...
	'k17',...
	'k18',...
	'k19');
inputs.PEsol.llk_type=	'hetero';


%%
% inputs.exps
%

inputs.exps.data_type=	'pseudo_pos';
inputs.exps.error_data=	{ 	[	    0.100499     0.100499    0.0092247    0.0044142   0.00048893      4.11804    0.0034263      3.43163   0.00015151    0.0068715      1.91189    0.0019314     0.008458     0.022848      1.59352     0.024731 
	   0.0116455    0.0116455    0.0501713    0.0443618  0.000754461      3.75262    0.0344335      3.11522   0.00152268     0.069058      1.84418    0.0184258    0.0845962     0.229623      1.61437    0.0281039 
	   0.0117101    0.0117101    0.0602071    0.0318494   0.00291019       3.7665    0.0293747      3.12564   0.00113111    0.0596145      1.84514    0.0194102     0.085002     0.228292      1.61472    0.0947285 
	   0.0119151    0.0119151    0.0663213    0.0240154   0.00426694      3.84949     0.022287      3.19495  0.000655046    0.0461709      1.86161    0.0117118    0.0658854     0.176796      1.61041     0.181535 
	   0.0120034    0.0120034     0.068675    0.0210159   0.00478603      3.89811    0.0187263      3.23657  0.000467808    0.0391681      1.87128   0.00788603    0.0540506      0.14526      1.60753      0.23313 
	   0.0120298    0.0120298    0.0692702    0.0202573   0.00491365      3.91676    0.0175046      3.25278  0.000411932    0.0367097        1.875   0.00658912    0.0493654     0.132848      1.60631     0.248542 
	   0.0124395    0.0124395    0.0916366   0.00455659  0.000573707      4.00002   0.00736666      3.32306  0.000164046    0.0163875      1.88917   0.00364561    0.0333075    0.0877189      1.60303     0.247719 
	   0.0126533    0.0126533    0.0927074    0.0044142   0.00048893      4.10138   0.00352446      3.41595  0.000151513   0.00713425      1.90883   0.00193266   0.00967665    0.0259465      1.59506     0.217202 
	   0.0126473    0.0126473    0.0916448   0.00451489  0.000505824       4.1143   0.00345405       3.4284   0.00015151   0.00692082      1.91134    0.0019314   0.00849784    0.0229565      1.59371      0.14923 
	   0.0118636    0.0118636     0.059797    0.0321464    0.0027379      3.90004    0.0224802      3.24047  0.000641886    0.0464115      1.87324   0.00627223     0.049809     0.136128      1.60554    0.0879739 
	   0.0117738    0.0117738    0.0605719    0.0313126   0.00296099      3.81727    0.0265045      3.16832  0.000911459    0.0542305      1.85594    0.0136551    0.0719451     0.194038      1.61168    0.0976363 
	   0.0118851    0.0118851    0.0650463    0.0256247   0.00397676       3.8459    0.0230394      3.19206  0.000696525    0.0476206       1.8611    0.0117705    0.0662889     0.178167      1.61047      0.15856 
	   0.0119759    0.0119759    0.0677977    0.0221248   0.00458956      3.88648    0.0197135       3.2266  0.000515156    0.0411226      1.86904   0.00866523    0.0567551      0.15255      1.60819     0.212079 
	   0.0120157    0.0120157    0.0688649    0.0207696   0.00482405      3.90913    0.0180743      3.24617  0.000437009    0.0378542      1.87351   0.00707452    0.0512132     0.137783      1.60679     0.237804 
	   0.0120256    0.0120256    0.0690428    0.0205409   0.00486047      3.91697    0.0175916      3.25303  0.000415199    0.0368759      1.87508   0.00653702     0.049213       0.1325      1.60626     0.242315 ]};
inputs.exps.exp_data=	{ 	[	    0.877569      1.10176    0.0109104  0.000363495  0.000494339      40.2706   0.00507706      34.2527 7.08171e-005    0.0055007      17.7221  0.000884493   0.00224351   0.00707042      16.6926    0.0128942 
	   0.0560095    0.0543133      0.57294     0.476223   0.00452281      38.2804     0.333603      34.1908    0.0166582     0.578596      18.8018     0.185565      0.86833      1.56593       16.922    0.0894357 
	   0.0324238    0.0667794     0.600649     0.428737    0.0252872      35.4457     0.305105      29.8978   0.00988512     0.631087      19.0289     0.230586     0.685928      2.45158      16.2973     0.975538 
	   0.0671381    0.0580597     0.731504     0.230661    0.0406157      36.1821     0.260544      29.6111   0.00610846     0.449945      15.4454      0.10997     0.569198      1.69173      16.9563      1.63381 
	   0.0812845     0.069658     0.605601      0.21858    0.0373554      37.5252     0.141842      33.2533   0.00386545     0.351498      17.0169    0.0877627     0.600412      1.42166      16.8992      2.51566 
	   0.0746076    0.0815124     0.565973     0.176678    0.0550879      38.3126     0.158193      29.6277   0.00363169     0.382457      17.1699    0.0585527     0.392295      1.48592      14.7929      2.23632 
	   0.0943988    0.0903675     0.897589   0.00878748   0.00280041      41.2125    0.0592609      31.3344  0.000807871      0.16213      18.3683    0.0265605     0.369621     0.714072       15.265        2.561 
	   0.0602874    0.0769648     0.886103   0.00395824  0.000934313      30.4054    0.0116921      31.3791  0.000112632    0.0175825       21.311  0.000106535    0.0368645     0.110223      16.2238      1.85419 
	    0.061978    0.0851892      1.00362   0.00731391  0.000964028      38.2296   0.00817773      31.3539 2.13332e-005   0.00042587      18.4481   0.00336328   0.00707829    0.0237788      17.8579      1.70645 
	   0.0686365    0.0555068      0.66702     0.357483    0.0304198      36.7148     0.244285      28.1473   0.00594873     0.455277      18.9676    0.0625488     0.436424      1.35366      16.6718      0.68806 
	   0.0580983    0.0600867     0.546581     0.310118    0.0242426      42.1749     0.256026      38.5692    0.0103528     0.474042      19.8942     0.126347     0.620113       2.1586      16.4476      1.10403 
	   0.0644651    0.0795119     0.645781     0.286978    0.0401716      33.1866     0.262784       34.953   0.00698219      0.55178      17.2794      0.11442     0.548997      1.52282      16.0156      1.35812 
	   0.0465649    0.0716274     0.596378     0.215213    0.0457066      43.3083     0.198343      34.0207   0.00454952     0.404793      22.8603    0.0737831     0.513444      1.70504      14.8954      1.91593 
	   0.0630598    0.0731291     0.597144     0.209844    0.0461603      38.2012     0.149316      26.9923    0.0042403     0.322621      18.3804    0.0798962     0.476578      1.44042      13.8127      2.44566 
	   0.0600753    0.0735267     0.758347     0.254787    0.0537565      39.0968     0.181508      35.0948    0.0033822     0.331695      14.7955    0.0578628     0.413574      1.27876        16.85      2.31835 ]};
inputs.exps.exp_y0=	{ 	[	           1            1 -1.3645e-017 -1.3645e-017 -1.0333e-034       40.976  3.5121e-011       34.146  2.3805e-021 -5.2419e-011       19.024  1.0252e-018   6.218e-011  4.1486e-009       15.854   6.504e-017  3.7963e-017  5.3131e-017 ]};
inputs.exps.n_exp=	1;
inputs.exps.n_obs=	{ 	[	          16 ]};
inputs.exps.n_s=	{ 	[	          15 ]};
inputs.exps.noise_type=	'hetero_lin';
inputs.exps.obs=	{ 	char(	'obsTGFb =TGFb                             ',...
	'obsTGFbR=TGFbR                            ',...
	'obsTGFb_TGFbR=TGFb_TGFbR                  ',...
	'obsTGFb_TGFbR_P=TGFb_TGFbR_P              ',...
	'obsI_Smad_TGFb_TGFbR_P=I_Smad_TGFb_TGFbR_P',...
	'obsSmad=Smad                              ',...
	'obsSmad_P=Smad_P                          ',...
	'obsCoSmad=CoSmad                          ',...
	'obsSmad_P_Smad_P=Smad_P_Smad_P            ',...
	'obsSmad_P_CoSmad=Smad_P_CoSmad            ',...
	'obsSmad_N=Smad_N                          ',...
	'obsSmad_P_Smad_P_N=Smad_P_Smad_P_N        ',...
	'obsSmad_P_N=Smad_P_N                      ',...
	'obsSmad_P_CoSmad_N=Smad_P_CoSmad_N        ',...
	'obsCoSmad_N=CoSmad_N                      ',...
	'obsI_Smad=I_Smad                          ');
};
inputs.exps.obs_names=	{ 	char(	'obsTGFb               ',...
	'obsTGFbR              ',...
	'obsTGFb_TGFbR         ',...
	'obsTGFb_TGFbR_P       ',...
	'obsI_Smad_TGFb_TGFbR_P',...
	'obsSmad               ',...
	'obsSmad_P             ',...
	'obsCoSmad             ',...
	'obsSmad_P_Smad_P      ',...
	'obsSmad_P_CoSmad      ',...
	'obsSmad_N             ',...
	'obsSmad_P_Smad_P_N    ',...
	'obsSmad_P_N           ',...
	'obsSmad_P_CoSmad_N    ',...
	'obsCoSmad_N           ',...
	'obsI_Smad                ');
};
inputs.exps.std_dev=	{ 	[	         0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1 ]};
inputs.exps.stddeva=	{ 	[	        0.01         0.01    0.0092247    0.0044142   0.00048893      0.40976    0.0034263      0.34146   0.00015151    0.0068715      0.19024    0.0019314     0.008458     0.022848      0.16067     0.024731 ]};
inputs.exps.stddevb=	{ 	[	         0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1 ]};
inputs.exps.t_f=	{ 	[	       18000 ]};
inputs.exps.t_s=	{ 	[	           0      1285.71      2571.43      3857.14      5142.86      6428.57      7714.29         9000      10285.7      11571.4      12857.1      14142.9      15428.6      16714.3        18000 ]};


%%
% inputs.ivpsol
%

inputs.ivpsol.atol=	1e-007;
inputs.ivpsol.ivpsolver=	'cvodes';
inputs.ivpsol.rtol=	1e-007;
inputs.ivpsol.senssolver=	'cvodes';


%%
% inputs.model
%

inputs.model.AMIGOjac=	0;
inputs.model.AMIGOsensrhs=	1;
inputs.model.eqns=	char(	'r1 = k1*TGFb_TGFbR                                   ',...
	'r2 = k2*TGFbR*TGFb                                   ',...
	'r3 = k3*TGFb_TGFbR*(1-exp(-((t-k20)/(k21))^10))      ',...
	'r4 = k4*TGFb_TGFbR_P                                 ',...
	'r5 = k5*TGFb_TGFbR_P*I_Smad                          ',...
	'r6 = k6*I_Smad_TGFb_TGFbR_P                          ',...
	'r7 = k7*Smad*TGFb_TGFbR_P                            ',...
	'r8 = k8*Smad                                         ',...
	'r9 = k9*Smad_N                                       ',...
	'r10 = k10*2*Smad_P*Smad_P                            ',...
	'r11 = k11*Smad_P_Smad_P                              ',...
	'r12 = k10*Smad_P*CoSmad                              ',...
	'r13 = k11*Smad_P_CoSmad                              ',...
	'r14 = k8*CoSmad                                      ',...
	'r15 = k9*CoSmad_N                                    ',...
	'r16 = k12*k8*Smad_P_Smad_P                           ',...
	'r17 = k8*Smad_P                                      ',...
	'r18 = k9*Smad_P_N                                    ',...
	'r19 = k12*k8*Smad_P_CoSmad                           ',...
	'r20 = k13*Smad_P_N                                   ',...
	'r21 = k10*2*Smad_P_N*Smad_P_N                        ',...
	'r22 = k11*Smad_P_Smad_P_N                            ',...
	'r23 = k10*Smad_P_N*CoSmad_N                          ',...
	'r24 = k11*Smad_P_CoSmad_N                            ',...
	'r25 = k14*Smad_P_CoSmad_N^2/(Smad_P_CoSmad_N^2+k15^2)',...
	'r26 = k16*I_Smad_mRNA1                               ',...
	'r27 = k17*I_Smad_mRNA2                               ',...
	'r28 = k18*I_Smad_mRNA2                               ',...
	'r29 = k19*I_Smad                                     ',...
	'dTGFb= r1-r2                                         ',...
	'dTGFbR= r1-r2                                        ',...
	'dTGFb_TGFbR= -r1+r2-r3+r4+r6                         ',...
	'dTGFb_TGFbR_P= r3-r4-r5                              ',...
	'dI_Smad_TGFb_TGFbR_P= r5-r6                          ',...
	'dSmad = -r7-r8+r9                                    ',...
	'dSmad_P = r7-r10+r11-r12+r13-r17+r18                 ',...
	'dCoSmad = -r12+r13-r14+r15                           ',...
	'dSmad_P_Smad_P = r10-r11-r16                         ',...
	'dSmad_P_CoSmad = r12-r13-r19                         ',...
	'dSmad_N = r8-r9+r20                                  ',...
	'dSmad_P_Smad_P_N = r16+r21-r22                       ',...
	'dSmad_P_N = r17-r18-r20-r21+r22-r23+r24              ',...
	'dSmad_P_CoSmad_N = r19+r23-r24                       ',...
	'dCoSmad_N = r14-r15-r23+r24                          ',...
	'dI_Smad_mRNA1 = r25-r26                              ',...
	'dI_Smad_mRNA2 = r26-r27                              ',...
	'dI_Smad = r28-r29-r5+r6                              ');
inputs.model.input_model_type=	'charmodelC';
inputs.model.n_par=	21;
inputs.model.n_st=	18;
inputs.model.n_stimulus=	0;
inputs.model.names_type=	'custom';
inputs.model.par=	[	     0.00015        0.023         0.01         0.01         0.01          0.1     0.000404       0.0026       0.0056        0.002        0.016          5.7      0.00657       0.0017            1       0.0008        0.001       0.0021        0.001         9000         1800 ];
inputs.model.par_names=	char(	'k1 ',...
	'k2 ',...
	'k3 ',...
	'k4 ',...
	'k5 ',...
	'k6 ',...
	'k7 ',...
	'k8 ',...
	'k9 ',...
	'k10',...
	'k11',...
	'k12',...
	'k13',...
	'k14',...
	'k15',...
	'k16',...
	'k17',...
	'k18',...
	'k19',...
	'k20',...
	'k21');
inputs.model.st_names=	char(	'TGFb               ',...
	'TGFbR              ',...
	'TGFb_TGFbR         ',...
	'TGFb_TGFbR_P       ',...
	'I_Smad_TGFb_TGFbR_P',...
	'Smad               ',...
	'Smad_P             ',...
	'CoSmad             ',...
	'Smad_P_Smad_P      ',...
	'Smad_P_CoSmad      ',...
	'Smad_N             ',...
	'Smad_P_Smad_P_N    ',...
	'Smad_P_N           ',...
	'Smad_P_CoSmad_N    ',...
	'CoSmad_N           ',...
	'I_Smad_mRNA1       ',...
	'I_Smad_mRNA2       ',...
	'I_Smad             ');
inputs.model.stimulus_names=	[];


%%
% inputs.nlpsol
%

inputs.nlpsol.nlpsolver=	'ess';


%%
% inputs.nlpsol.eSS
%

inputs.nlpsol.eSS.log_var=	[	           1            2            3            4            5            6            7            8            9           10           11           12           13           14           15           16           17           18 ];
inputs.nlpsol.eSS.maxeval=	20000;
inputs.nlpsol.eSS.maxtime=	900;


%%
% inputs.nlpsol.eSS.local
%

inputs.nlpsol.eSS.local.finish=	'nl2sol';
inputs.nlpsol.eSS.local.solver=	'nl2sol';


%%
% inputs.nlpsol.eSS.local.nl2sol
%

inputs.nlpsol.eSS.local.nl2sol.maxfeval=	150;


%%
% inputs.pathd
%

inputs.pathd.results_folder=	'Overfitting\TGFBeta';
inputs.pathd.runident=	[];
inputs.pathd.short_name=	'tgfbSP';


%%
% inputs.plotd
%

inputs.plotd.plotlevel=	'noplot';
